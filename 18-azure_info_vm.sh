#!/bin/bash

# Function to check if an Azure session is active
check_session() {
    az account show &> /dev/null
    if [ $? -eq 0 ]; then
        echo "An active Azure session is already present."
        display_session_info
    else
        echo "No active Azure session found."
        display_login_options
    fi
}

# Function to display Azure login options
display_login_options() {
    echo "Please choose one of the login options below:"
    echo "-------------------------------------------"
    echo "1. Log in using a device code (browser-based login):"
    echo "   az login --use-device-code"
    echo
}

# Function to display information about the current session
display_session_info() {
    echo "Available VMs (basic details):"
    az vm list --output table
    echo
    echo "VMs with details including IP addresses:"
    az vm list --show-details --output table
}

# Main script execution
check_session
