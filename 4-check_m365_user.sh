#!/bin/bash

# Check if an email address was provided
if [ -z "$1" ]; then
  echo "Usage: $0 [email_address]"
  exit 1
fi

EMAIL=$1
USERLIST_FILE="/tmp/userlist.txt"

# Create a temporary file with the provided email address
echo "$EMAIL" > $USERLIST_FILE

# Execute the o365enum script with the userlist file
/opt/pentestcloud/o365enum/o365enum.py -u "$USERLIST_FILE" -n 1 -m office.com

# Check the result and display a message
if [ $? -eq 0 ]; then
  echo "The user $EMAIL was found in Office 365."
else
  echo "The user $EMAIL does not exist in Office 365 or an error occurred."
fi

# Clean up the temporary file
rm -f $USERLIST_FILE
