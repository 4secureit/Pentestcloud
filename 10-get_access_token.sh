#!/bin/bash

# Get access token from Azure CLI and extract only the accessToken value
token=$(az account get-access-token --query accessToken --output tsv)

# Display the token
echo "Access Token: $token"

# Get the current date in YYYY-MM-DD format
current_date=$(date +"%Y-%m-%d")

# Define the folder and filename
folder="/10"
filename="$folder/token_$current_date.txt"

# Check if the folder exists, if not, create it
if [ ! -d "$folder" ]; then
    mkdir -p "$folder"
    echo "Folder $folder created."
fi

# Save the token to the file
echo "$token" > "$filename"

# Inform the user
echo "Token saved to file: $filename"
